<link rel="import" href="../../elements/elements.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">

<dom-module id="my-docenten">
  <link rel="import" type="css" href="../../styles/mainStyle.css">
  <template>

    <iron-ajax
      id="ajax_docenten"
      method="POST"
      url="/docenten/info"
      handle-as="json"
      on-response="ajax_docenten_handler">
    </iron-ajax>

    <h1>Docenten</h1>

    <paper-card class="holder" elevation="2">

      <brainy-table items="[[docenten]]" page-size="[[docenten.length]]" details-enabled>
        <brainy-table-column name="Voornaam" sort-by="item.voornaam">
          <template>[[item.voornaam]]</template>
        </brainy-table-column>

        <brainy-table-column name="Tussenvoegsel">
          <template>[[item.tussenvoegsel]]</template>
        </brainy-table-column>

        <brainy-table-column name="Achternaam">
          <template>[[item.achternaam]]</template>
        </brainy-table-column>

        <brainy-table-column name="Ziek">
          <template>[[item.ziek]]</template>
        </brainy-table-column>

        <brainy-table-column width="30px" align-right flex="0">
          <template>
            <template is="dom-if" if="[[!expanded]]">
              <iron-icon icon="icons:expand-more"></iron-icon>
            </template>
            <template is="dom-if" if="[[expanded]]">
              <iron-icon icon="icons:expand-less"></iron-icon>
            </template>
          </template>
        </brainy-table-column>

         <template is="row-detail">
           <div>
             <paper-button class="red" on-tap="ajax_zet_status_onClick">Afwezig melden</paper-button>
             <paper-button class="green" on-tap="ajax_beter_melden_onClick">Aanwezig melden</paper-button>
           </div>
         </template>

         <div no-results>No records found</div>
      </brainy-table>

    </paper-card>

  </template>

  <script>

  Polymer({

    is: 'my-docenten',

    properties: {
      gebruiker:{
        type: Object
      }
    },

    ajax_docenten_start: function(){
      this.$.ajax_docenten.contentType="application/json";
      this.$.ajax_docenten.body={
      };

      this.$.ajax_docenten.generateRequest();
    },

    ajax_docenten_handler: function(request){

      this.docenten = request.detail.response;
    },

    update: function() {
      //Ingelogde gebruiker ophalen
      this.gebruiker = JSON.parse(localStorage.getItem("gebruiker"));

      //Als gebruiker niet is ingelogd terug sturen naar login scherm
      if(this.gebruiker == null) {
        this.$.redirect_login.click();

        return;
      }

      //Admin naar admin scherm toe sturen
      if(this.gebruiker.rol =! 'admin'){
        this.$.redirect_home.click();

        return;
      }

      this.ajax_docenten_start();
    }


  })

  </script>

</dom-module>
